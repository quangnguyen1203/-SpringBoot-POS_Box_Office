<!DOCTYPE html>
<html lang="en" xmlns:th="http://www.thymeleaf.org">

<head>
    <title>HOME</title>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta content="Responsive bootstrap 4 admin template" name="description">
    <meta content="Coderthemes" name="author">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <!-- App favicon -->

    <link rel="shortcut icon" href="/assets/images/favicon.ico">

    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.0.2/dist/css/bootstrap.min.css" rel="stylesheet">
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.0.2/dist/js/bootstrap.bundle.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/@popperjs/core@2.9.2/dist/umd/popper.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.0.2/dist/js/bootstrap.min.js"></script>
    <link rel="stylesheet" href="/resource/css/jquery.dataTables.min.css">


    <!-- App css -->
    <link href="/assets/css/bootstrap.min.css" rel="stylesheet" type="text/css" id="bootstrap-stylesheet">
    <link href="/assets/css/icons.min.css" rel="stylesheet" type="text/css">
    <link href="/assets/css/app.min.css" rel="stylesheet" type="text/css" id="app-stylesheet">
    <link rel="stylesheet" href="/resource/css/sweetalert2.min.css">
    <script type="text/javascript" src="/resource/js/sweetalert2.min.js"></script>
</head>



<body>

<!-- Begin page -->
<div id="wrapper">

    <div id="side-bar">
        <!-- Topbar Start -->
        <div class="navbar-custom">
            <ul class="list-unstyled topnav-menu float-right mb-0">
                <li class="dropdown notification-list">
                    <a class="nav-link dropdown-toggle nav-user mr-0 waves-effect" data-toggle="dropdown" href="#" role="button" aria-haspopup="false" aria-expanded="false">
                        <img src="/assets/images/admin-avatar.jpg" alt="user-image" class="rounded-circle">
                        <span class="pro-user-name ml-1">
                                <span > USER <i class="mdi mdi-chevron-down"></i>
                            </span>
          </span>
                    </a>
                    <div class="dropdown-menu dropdown-menu-right profile-dropdown ">
                        <!-- item-->
                        <div class="dropdown-header noti-title">
                            <h6 class="text-overflow m-0">Welcome !</h6>
                        </div>


                        <div class="dropdown-divider"></div>

                        <!-- item-->
                        <!--                    <div sec:authorize="isAuthenticated()">-->
                        <!--                        <a th:href="@{/home}">Home</a> | <a th:href="@{/logout}">Logout</a>-->
                        <!--                    </div>-->
                        <a href="javascript:void(0);" class="dropdown-item notify-item">
                            <p> <i class="mdi mdi-logout-variant"></i> Logout</p>
                        </a>

                    </div>
                </li>
            </ul>

            <!-- LOGO -->
            <div class="logo-box">
                <a href="#" class="logo text-center logo-dark">
                        <span class="logo-lg">
                            <img src="/assets/images/logo-dark.png" alt="" height="18">
                            <!-- <span class="logo-lg-text-dark">Velonic</span> -->
                        </span>
                    <span class="logo-sm">
                            <!-- <span class="logo-lg-text-dark">V</span> -->
                            <img src="/assets/images/logo-sm.png" alt="" height="22">
                        </span>
                </a>

                <a href="#" class="logo text-center logo-light">
                        <span class="logo-lg">
                            <img src="/assets/images/logo-light.png" alt="" height="18">
                            <!-- <span class="logo-lg-text-dark">Velonic</span> -->
                        </span>
                    <span class="logo-sm">
                            <!-- <span class="logo-lg-text-dark">V</span> -->
                            <img src="/assets/images/logo-sm.png" alt="" height="22">
                        </span>
                </a>
            </div>

            <!-- LOGO -->


            <ul class="list-unstyled topnav-menu topnav-menu-left m-0">
                <li>
                    <button class="button-menu-mobile waves-effect">
                        <i class="mdi mdi-menu"></i>
                    </button>
                </li>

                <!--            <li class="d-none d-lg-block">-->
                <!--                <form class="app-search">-->
                <!--                    <div class="app-search-box">-->
                <!--                        <div class="input-group">-->
                <!--                            <input type="text" class="form-control" placeholder="Search...">-->
                <!--                            <div class="input-group-append">-->
                <!--                                <button class="btn" type="submit">-->
                <!--                                    <i class="fas fa-search"></i>-->
                <!--                                </button>-->
                <!--                            </div>-->
                <!--                        </div>-->
                <!--                    </div>-->
                <!--                </form>-->
                <!--            </li>-->
            </ul>
        </div>
        <!-- end Topbar --> <!-- ========== Left Sidebar Start ========== -->
        <div class="left-side-menu">

            <div class="slimscroll-menu">

                <!--- Sidemenu -->
                <div id="sidebar-menu">
                    <ul class="metismenu" id="side-menu">

                        <li class="menu-title">Navigation</li>

                        <li>
                            <a  href="#" class="waves-effect">
                                <i class="ion-md-speedometer"></i>
                                <span >  Dashboard  </span>
                            </a>
                        </li>

                        <li>
                            <a href="javascript: void(0);" class="waves-effect">
                                <i class="fas fa-money-check-alt"></i>
                                <span> Order </span>
                                <span class="menu-arrow"></span>
                            </a>
                            <ul class="nav-second-level" aria-expanded="false">
                                <li><a href="#">List Order</a></li>
                                <li><a href="#">List OrderDetail</a></li>

                                <!--                            <li><a th:href="@{/products/hiddenProduct}">Hidden Product</a></li>-->
                            </ul>
                        </li>

                        <li>
                            <a href="javascript: void(0);" class="waves-effect">
                                <i class="fas fa-tasks"></i>
                                <span> Product </span>
                                <span class="menu-arrow"></span>
                            </a>
                            <ul class="nav-second-level" aria-expanded="false">
                                <li><a href="/products/">List Product</a></li>
                                <li><a href="#">Create Product</a></li>
                                <li><a href="#">Hidden Product</a></li>
                            </ul>
                        </li>

                        <li>
                            <a href="javascript: void(0);" class="waves-effect">
                                <i class="fas fa-users"></i>
                                <span> User </span>
                                <span class="menu-arrow"></span>
                            </a>
                            <ul class="nav-second-level" aria-expanded="false">
                                <li><a href="#">List User</a></li>
                                <li><a href="#">Create User</a></li>
                            </ul>
                        </li>

                        <li>
                            <a href="javascript: void(0);" class="waves-effect">
                                <i class="fas fa-clipboard-list"></i>
                                <span> Category </span>
                                <span class="menu-arrow"></span>
                            </a>
                            <ul class="nav-second-level" aria-expanded="false">
                                <li><a href="#">List Category</a></li>
                            </ul>
                        </li>

                        <li>
                            <a href="javascript: void(0);" class="waves-effect">
                                <i class="fas fa-coins"></i>
                                <span> Voucher </span>
                                <span class="menu-arrow"></span>
                            </a>
                            <ul class="nav-second-level" aria-expanded="false">
                                <li><a href="#">List Voucher</a></li>
                                <li><a href="#">Create Voucher</a></li>
                                <li>
                                    <a href="javascript: void(0);" class="waves-effect">
                                        <span>Type Voucher </span>
                                        <span class="menu-arrow"></span>
                                    </a>
                                    <ul class="nav-second-level" aria-expanded="false">
                                        <li><a href="#">Expired Voucher</a></li>
                                        <li><a href="#">Undue Voucher</a></li>
                                    </ul>
                                </li>
                            </ul>
                        </li>
                    </ul>

                </div>
                <!-- End Sidebar -->

                <div class="clearfix"></div>

            </div>
            <!-- Sidebar -left -->

        </div>
        <!-- Left Sidebar End -->
    </div>

    <!-- ============================================================== -->
    <!-- Start Page Content here -->
    <!-- ============================================================== -->

    <div class="content-page">
        <div class="content">

            <!-- Start Content-->
            <div class="row">
                <div class="col-lg-12" style="margin-top: 10px;">
                    <div class="card">
                        <div class="card-body">
                            <h4 class="header-title mb-4">Create Product</h4>

                            <form class="parsley-examples" id="create-form">
                                <div class="form-group">
                                    <label>Product Name<span class="text-danger">*</span></label>
                                    <input type="text" name="product_name" parsley-trigger="change" required placeholder="Enter product name" class="form-control" id="product_name">
                                </div>
                                <div class="form-group">
                                    <label>Price<span class="text-danger">*</span></label>
                                    <input type="number" name="price" parsley-trigger="change" required placeholder="Enter price" class="form-control" id="price">
                                </div>
                                <div class="form-group">
                                    <label>Description<span class="text-danger">*</span></label>
                                    <input id="description" type="text" placeholder="Enter description" required class="form-control">
                                </div>
                                <div class="form-group">
                                    <label>Category</label>
                                    <select class="form-control" name="upCountry" id="category" value="">
                                    </select>
                                </div>
                                <div class="form-group text-right mb-0">
                                    <button class="btn btn-primary waves-effect waves-light mr-1" id="create-button" type="button">
                                        Submit
                                    </button>
                                    <button type="reset" class="btn btn-secondary waves-effect waves-light">
                                        Cancel
                                    </button>
                                </div>

                            </form>
                        </div>
                    </div>
                    <!-- end card -->
                </div>
                <!-- end col -->
            </div>
            <!-- end container-fluid -->

        </div>
        <!-- end content -->

    <!-- ============================================================== -->
    <!-- End Page content -->
    <!-- ============================================================== -->

</div>
<!-- END wrapper -->
</div>

</body>
<!-- Vendor js -->
<script src="/assets/js/vendor.min.js"></script>

<!--Morris Chart-->
<script src="/assets/libs/morris-js/morris.min.js"></script>
<script src="/assets/libs/raphael/raphael.min.js"></script>

<!-- Init js -->
<script src="/assets/js/pages/morris.init.js"></script>

<!-- App js -->
<script src="/assets/js/app.min.js"></script>

<!-- My Javascript -->
<script src="/assets/js/myjs.js"></script>
<script src="/resource/js/app.js"></script>

<script type="text/javascript" src="/resource/js/jquery-3.6.0.min.js"></script>
<script type="text/javascript" src="/resource/js/jquery.validate-1.19.3.min.js"></script>
<script src="/resource/js/jquery.dataTables.min.js"></script>
<script type="text/javascript" src="/resource/js/jquery-3.6.0.min.js"></script>
<script type="text/javascript" src="/resource/js/jquery.validate-1.19.3.min.js"></script>

<script>
    $(() => {
        $("#create-form").validate({
            errorElement: 'div',
            rules: {
                product_name:  {
                required: true,
                minlength: 5,
                maxlength: 50,
                },
                price: {
                    required: true,
                    number: true
                },
                upCountry:{
                    required:true
                },
                inputImage: {
                    required:true
                }
            },

            messages: {
                product_name: {
                required: "Please enter product name!",
                minlength: "Please enter at least 5 characters!",
                maxlength: "Please enter up to 50 characters!"
                },
                price: {
                    required: "Please input price of product!",
                    number: "Please input only number!"
                },
                upCountry: "Please choose product category!",
                inputImage: "Please choose product image!"
            },

            submitHandler : createProduct
        });
    });

</script>


<script>
    function getAllCategory(){
        $.ajax({
            type: "GET",
            url: "/products/allCategory"
        }).done(function (category){
            let content = "";
            for (let i = 0; i < category.length; i++) {
                content += `
                    <option value="${category[i].category_id}">${category[i].category_name}</option>
                `;
            }
            $("#category").html(content);
        })
    }

    function createProduct(){
        let product_name = $("#product_name").val();
        let price = $("#price").val();
        let description = $("#description").val();
        let category = $("#category").val();

        let newCategory = {
            category_id : category
        }

        let product = {
            product_name : product_name,
            price : price,
            description : description,
            category : newCategory
        }

        if ($("#create-form").valid()){
            $.ajax({
                headers: {
                    'Accept': 'application/json',
                    'Content-Type': 'application/json'
                },
                type: "POST",
                data: JSON.stringify(product),
                url: "/products/createNewProduct"
            }).done(function (){
                $("#create-form")[0].reset();
                App.showSuccessAlert("Create new product successfully!");
            }).fail(()=>{
                App.showErrorAlert("Something went wrong!");
            })
        }
    }

    $("#create-button").on("click",createProduct);
    getAllCategory();
</script>

</html>