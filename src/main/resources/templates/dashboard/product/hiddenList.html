<!DOCTYPE html>
<html lang="en" xmlns:th="http://www.thymeleaf.org">

<head>
  <title>HOME</title>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <meta content="Responsive bootstrap 4 admin template" name="description">
  <meta content="Coderthemes" name="author">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <!-- App favicon -->

  <link rel="shortcut icon" href="/assets/images/favicon.ico">

  <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.0.2/dist/css/bootstrap.min.css" rel="stylesheet">
  <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.0.2/dist/js/bootstrap.bundle.min.js"></script>
  <script src="https://cdn.jsdelivr.net/npm/@popperjs/core@2.9.2/dist/umd/popper.min.js"></script>
  <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.0.2/dist/js/bootstrap.min.js"></script>
  <link rel="stylesheet" href="/resource/css/jquery.dataTables.min.css">


  <!-- App css -->
  <link href="/assets/css/bootstrap.min.css" rel="stylesheet" type="text/css" id="bootstrap-stylesheet">
  <link href="/assets/css/icons.min.css" rel="stylesheet" type="text/css">
  <link href="/assets/css/app.min.css" rel="stylesheet" type="text/css" id="app-stylesheet">
  <link rel="stylesheet" href="/resource/css/sweetalert2.min.css">
  <script type="text/javascript" src="/resource/js/sweetalert2.min.js"></script>
</head>

<body>

<!-- Begin page -->
<div id="wrapper">

  <div id="side-bar">
    <!-- Topbar Start -->
    <div class="navbar-custom">
      <ul class="list-unstyled topnav-menu float-right mb-0">
        <li class="dropdown notification-list">
          <a class="nav-link dropdown-toggle nav-user mr-0 waves-effect" data-toggle="dropdown" href="#" role="button" aria-haspopup="false" aria-expanded="false">
            <img src="/assets/images/admin-avatar.jpg" alt="user-image" class="rounded-circle">
            <span class="pro-user-name ml-1">
                                <span > USER <i class="mdi mdi-chevron-down"></i>
                            </span>
          </span>
          </a>
          <div class="dropdown-menu dropdown-menu-right profile-dropdown ">
            <!-- item-->
            <div class="dropdown-header noti-title">
              <h6 class="text-overflow m-0">Welcome !</h6>
            </div>


            <div class="dropdown-divider"></div>

            <!-- item-->
            <!--                    <div sec:authorize="isAuthenticated()">-->
            <!--                        <a th:href="@{/home}">Home</a> | <a th:href="@{/logout}">Logout</a>-->
            <!--                    </div>-->
            <a href="javascript:void(0);" class="dropdown-item notify-item">
              <p> <i class="mdi mdi-logout-variant"></i> Logout</p>
            </a>

          </div>
        </li>
      </ul>

      <!-- LOGO -->
      <div class="logo-box">
        <a href="#" class="logo text-center logo-dark">
                        <span class="logo-lg">
                            <img src="/assets/images/logo-dark.png" alt="" height="18">
                          <!-- <span class="logo-lg-text-dark">Velonic</span> -->
                        </span>
          <span class="logo-sm">
                            <!-- <span class="logo-lg-text-dark">V</span> -->
                            <img src="/assets/images/logo-sm.png" alt="" height="22">
                        </span>
        </a>

        <a href="#" class="logo text-center logo-light">
                        <span class="logo-lg">
                            <img src="/assets/images/logo-light.png" alt="" height="18">
                          <!-- <span class="logo-lg-text-dark">Velonic</span> -->
                        </span>
          <span class="logo-sm">
                            <!-- <span class="logo-lg-text-dark">V</span> -->
                            <img src="/assets/images/logo-sm.png" alt="" height="22">
                        </span>
        </a>
      </div>

      <!-- LOGO -->


      <ul class="list-unstyled topnav-menu topnav-menu-left m-0">
        <li>
          <button class="button-menu-mobile waves-effect">
            <i class="mdi mdi-menu"></i>
          </button>
        </li>

        <!--            <li class="d-none d-lg-block">-->
        <!--                <form class="app-search">-->
        <!--                    <div class="app-search-box">-->
        <!--                        <div class="input-group">-->
        <!--                            <input type="text" class="form-control" placeholder="Search...">-->
        <!--                            <div class="input-group-append">-->
        <!--                                <button class="btn" type="submit">-->
        <!--                                    <i class="fas fa-search"></i>-->
        <!--                                </button>-->
        <!--                            </div>-->
        <!--                        </div>-->
        <!--                    </div>-->
        <!--                </form>-->
        <!--            </li>-->
      </ul>
    </div>
    <!-- end Topbar --> <!-- ========== Left Sidebar Start ========== -->
    <div class="left-side-menu">

      <div class="slimscroll-menu">

        <!--- Sidemenu -->
        <div id="sidebar-menu">
          <ul class="metismenu" id="side-menu">

            <li class="menu-title">Navigation</li>

            <li>
              <a  href="#" class="waves-effect">
                <i class="ion-md-speedometer"></i>
                <span >  Dashboard  </span>
              </a>
            </li>

            <li>
              <a href="javascript: void(0);" class="waves-effect">
                <i class="fas fa-money-check-alt"></i>
                <span> Order </span>
                <span class="menu-arrow"></span>
              </a>
              <ul class="nav-second-level" aria-expanded="false">
                <li><a href="#">List Order</a></li>
                <li><a href="#">List OrderDetail</a></li>

                <!--                            <li><a th:href="@{/products/hiddenProduct}">Hidden Product</a></li>-->
              </ul>
            </li>

            <li>
              <a href="javascript: void(0);" class="waves-effect">
                <i class="fas fa-tasks"></i>
                <span> Product </span>
                <span class="menu-arrow"></span>
              </a>
              <ul class="nav-second-level" aria-expanded="false">
                <li><a href="/products/">List Product</a></li>
                <li><a href="/products/createNewProduct">Create Product</a></li>
                <li><a href="#">Hidden Product</a></li>
              </ul>
            </li>

            <li>
              <a href="javascript: void(0);" class="waves-effect">
                <i class="fas fa-users"></i>
                <span> User </span>
                <span class="menu-arrow"></span>
              </a>
              <ul class="nav-second-level" aria-expanded="false">
                <li><a href="#">List User</a></li>
                <li><a href="#">Create User</a></li>
              </ul>
            </li>

            <li>
              <a href="javascript: void(0);" class="waves-effect">
                <i class="fas fa-clipboard-list"></i>
                <span> Category </span>
                <span class="menu-arrow"></span>
              </a>
              <ul class="nav-second-level" aria-expanded="false">
                <li><a href="#">List Category</a></li>
              </ul>
            </li>

            <li>
              <a href="javascript: void(0);" class="waves-effect">
                <i class="fas fa-coins"></i>
                <span> Voucher </span>
                <span class="menu-arrow"></span>
              </a>
              <ul class="nav-second-level" aria-expanded="false">
                <li><a href="#">List Voucher</a></li>
                <li><a href="#">Create Voucher</a></li>
                <li>
                  <a href="javascript: void(0);" class="waves-effect">
                    <span>Type Voucher </span>
                    <span class="menu-arrow"></span>
                  </a>
                  <ul class="nav-second-level" aria-expanded="false">
                    <li><a href="#">Expired Voucher</a></li>
                    <li><a href="#">Undue Voucher</a></li>
                  </ul>
                </li>
              </ul>
            </li>
          </ul>

        </div>
        <!-- End Sidebar -->

        <div class="clearfix"></div>

      </div>
      <!-- Sidebar -left -->

    </div>
    <!-- Left Sidebar End -->
  </div>

  <!-- ============================================================== -->
  <!-- Start Page Content here -->
  <!-- ============================================================== -->

  <div class="content-page">
    <div class="content">

      <!-- Start Content-->
      <div class="container-fluid">

        <!-- start page title -->
        <div class="row">
          <div class="col-12" style="margin-top: 10px;">
            <div class="page-title-box">
              <h4 class="page-title">Product Table</h4>
              <div class="clearfix"></div>
            </div>
          </div>
        </div>
        <!-- end page title -->

        <div class="row">
          <div class="col-12">
            <div class="card">
              <div class="card-body">
                <h4 class="header-title mb-4">Product List</h4>
                <div class="table-responsive">
                  <table class="table table-centered mb-0 table-nowrap" id="productList">
                    <thead>
                    <tr>
                      <th>Name</th>
                      <th>Price</th>
                      <th>Description</th>
                      <th>Category</th>
                      <th class="text-center">Action</th>
                    </tr>
                    </thead>
                    <tbody>

                    </tbody>
                  </table>
                </div>
                <!-- end .table-responsive-->
              </div>
              <!-- end card-body -->
            </div>
            <!-- end card -->
          </div>
          <!-- end col -->
        </div>
        <!-- end row -->

      </div>
      <!-- end container-fluid -->

    </div>
    <!-- end content -->

  </div>

  <!-- ============================================================== -->
  <!-- End Page content -->
  <!-- ============================================================== -->

</div>
<!-- END wrapper -->
</body>
<!-- Vendor js -->
<script src="/assets/js/vendor.min.js"></script>

<!--Morris Chart-->
<script src="/assets/libs/morris-js/morris.min.js"></script>
<script src="/assets/libs/raphael/raphael.min.js"></script>

<!-- Init js -->
<script src="/assets/js/pages/morris.init.js"></script>

<!-- App js -->
<script src="/assets/js/app.min.js"></script>

<!-- My Javascript -->
<script src="/resource/js/app.js"></script>

<script type="text/javascript" src="/resource/js/jquery-3.6.0.min.js"></script>
<script type="text/javascript" src="/resource/js/jquery.validate-1.19.3.min.js"></script>

<script>

  function getAllProduct(){
    $.ajax({
      type: "GET",
      url: "/products/allHiddenProduct"
    }).done(function (product){
      let content = "";
      for (let i = product.length-1; i >= 0; i--) {
        content += `
                        <tr id="row${product[i].product_id}">
                              <input hidden id="${product[i].product_id}">
                              <td>${product[i].product_name}</td>
                              <td>${product[i].price + "$"}</td>
                              <td>${product[i].description}</td>
                              <td>${product[i].category.category_name}</td>
                              <td class="text-center">
                                <button value="${product[i].product_id}" class="btn btn-outline-primary delete-button" ><i class="fas fa-trash-restore"></i>Restore</button>
                              </td>
                        </tr>
                `;
      }
      $("#productList tbody").html(content);
      $(".delete-button").on("click", function (){
        App.showDeleteConfirmDialog().then((result) => {
          if (result.isConfirmed){
            let id = $(this).attr("value");
            deleteConfirm(id);
          }
        });
      })
    })
  }

  function deleteConfirm(productID) {
    $.ajax({
      type : "POST",
      url : `/products/${productID}`
    }).done(function (){
      $("#row" + productID).remove();
      App.showSuccessAlert("Restore")
    }).fail(function (){
      App.showErrorAlert("Something went wrong!")
    })
  }

  getAllProduct();

  $(".delete-button").on("click",deleteConfirm);
</script>
</html>